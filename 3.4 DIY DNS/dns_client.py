import socket
from dns_server import DNSframe
from dns_server import MalformedFrameError

if __name__ == '__main__':
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    #s.connect(("8.8.8.8", 53))
    malformed = b"\xb1\xed\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x06\x64\x69\x73\x71\x75\x73\x03\x63\x6f\x6d\x00\x00"
    query = b"\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x06\x64\x69\x73\x71\x75\x73\x03\x63\x6f\x6d\x00\x00\x01\x00\x01"
    tc = b'\xb1\xed\x03\x00\x00\x05\x00\x00\x00\x00\x00\x00\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01'
    ntc = b'\xb1\xed\x01\x00\x00\x05\x00\x00\x00\x00\x00\x00\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01\x06disqus\x03com\x00\x00\x01\x00\x01'
    smol = b'\xb1\xed\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x06disqus\x03com\x00\x00\x01\x00\x01'
    s.sendto(smol, ("127.0.0.1", 12341))
    # s.sendall((len(smol)).to_bytes(2, 'big') + smol)
    data = s.recv(1024)
    print(data)
    try:
        frame = DNSframe(data[:])
        print(frame.answers)
    except MalformedFrameError:
        print("Problemo")

